==========Running command for DE, pred_len 24:==========
args: Namespace(dset_pretrain='DE', context_points=336, target_points=24, batch_size=128, num_workers=0, features='M', patch_len=12, stride=12, revin=1, overlapping_windows=True, scaler_type='minmax', if_relu=False, n_layers=3, n_heads=16, d_model=128, d_ff=512, dropout=0.2, head_dropout=0.2, mask_ratio=0.4, n_epochs_pretrain=100, lr=0.0001, pretrained_model_id=1, model_type='based_model')
scaler_type: minmax overlapping_windows: True
number of patches: 28
number of model params 601612
suggested_lr 9.770099572992256e-05
scaler_type: minmax overlapping_windows: True
number of patches: 28
number of model params 601612
          epoch     train_loss     valid_loss           time
Better model found at epoch 0 with valid_loss value: 0.9498899501869873.
              0       1.017526       0.949890          00:06
Better model found at epoch 1 with valid_loss value: 0.9315660908346067.
              1       0.974676       0.931566          00:06
Better model found at epoch 2 with valid_loss value: 0.9224605133856764.
              2       0.952208       0.922461          00:06
Better model found at epoch 3 with valid_loss value: 0.918409985975953.
              3       0.940268       0.918410          00:06
Better model found at epoch 4 with valid_loss value: 0.9173153783225431.
              4       0.931466       0.917315          00:06
Better model found at epoch 5 with valid_loss value: 0.9133406417132459.
              5       0.925833       0.913341          00:06
Better model found at epoch 6 with valid_loss value: 0.9118286741495094.
              6       0.921997       0.911829          00:06
Better model found at epoch 7 with valid_loss value: 0.9116110406697362.
              7       0.918006       0.911611          00:06
Better model found at epoch 8 with valid_loss value: 0.9108078938042866.
              8       0.916365       0.910808          00:06
Better model found at epoch 9 with valid_loss value: 0.9076414876799501.
              9       0.914534       0.907641          00:06
             10       0.913339       0.908601          00:06
             11       0.912535       0.909520          00:06
             12       0.910362       0.908028          00:06
Better model found at epoch 13 with valid_loss value: 0.9072668533607448.
             13       0.910515       0.907267          00:06
Better model found at epoch 14 with valid_loss value: 0.9065826941249799.
             14       0.909744       0.906583          00:06
             15       0.909257       0.908642          00:06
             16       0.908669       0.908480          00:06
Better model found at epoch 17 with valid_loss value: 0.9052168103838266.
             17       0.908477       0.905217          00:06
             18       0.908008       0.906138          00:06
             19       0.908741       0.907061          00:06
             20       0.906467       0.906935          00:06
Better model found at epoch 21 with valid_loss value: 0.9045979961697764.
             21       0.906564       0.904598          00:06
             22       0.906827       0.905676          00:07
Better model found at epoch 23 with valid_loss value: 0.6805314875040213.
             23       0.808100       0.680531          00:06
Better model found at epoch 24 with valid_loss value: 0.6185452548832837.
             24       0.674822       0.618545          00:06
Better model found at epoch 25 with valid_loss value: 0.5643611550235242.
             25       0.607821       0.564361          00:06
Better model found at epoch 26 with valid_loss value: 0.5072882868420259.
             26       0.563135       0.507288          00:06
Better model found at epoch 27 with valid_loss value: 0.4835636064671465.
             27       0.533419       0.483564          00:06
Better model found at epoch 28 with valid_loss value: 0.45430631547068523.
             28       0.512647       0.454306          00:06
Better model found at epoch 29 with valid_loss value: 0.4022081119561284.
             29       0.473439       0.402208          00:06
Better model found at epoch 30 with valid_loss value: 0.38082195083792425.
             30       0.432107       0.380822          00:06
Better model found at epoch 31 with valid_loss value: 0.37381876306900436.
             31       0.414110       0.373819          00:06
Better model found at epoch 32 with valid_loss value: 0.36862591514446275.
             32       0.404967       0.368626          00:06
Better model found at epoch 33 with valid_loss value: 0.3655654590613439.
             33       0.397344       0.365565          00:06
Better model found at epoch 34 with valid_loss value: 0.3623883715392271.
             34       0.390300       0.362388          00:06
Better model found at epoch 35 with valid_loss value: 0.35591838972273604.
             35       0.384758       0.355918          00:06
Better model found at epoch 36 with valid_loss value: 0.3532158782747909.
             36       0.380931       0.353216          00:06
Better model found at epoch 37 with valid_loss value: 0.34641049271403007.
             37       0.375275       0.346410          00:05
Better model found at epoch 38 with valid_loss value: 0.31527378621622165.
             38       0.366471       0.315274          00:05
Better model found at epoch 39 with valid_loss value: 0.2618830746654838.
             39       0.325696       0.261883          00:06
Better model found at epoch 40 with valid_loss value: 0.25785072919389374.
             40       0.301552       0.257851          00:07
Better model found at epoch 41 with valid_loss value: 0.25525432486654537.
             41       0.292421       0.255254          00:06
Better model found at epoch 42 with valid_loss value: 0.2532704319431599.
             42       0.286047       0.253270          00:06
Better model found at epoch 43 with valid_loss value: 0.25025647135626106.
             43       0.281130       0.250256          00:06
Better model found at epoch 44 with valid_loss value: 0.24511180753126507.
             44       0.276294       0.245112          00:06
             45       0.272935       0.245303          00:06
Better model found at epoch 46 with valid_loss value: 0.2412482634874638.
             46       0.268020       0.241248          00:06
Better model found at epoch 47 with valid_loss value: 0.2393595999376709.
             47       0.264776       0.239360          00:06
Better model found at epoch 48 with valid_loss value: 0.23595050617259128.
             48       0.261366       0.235951          00:06
             49       0.257976       0.236877          00:06
Better model found at epoch 50 with valid_loss value: 0.23188595942828133.
             50       0.254950       0.231886          00:06
Better model found at epoch 51 with valid_loss value: 0.2297869076850772.
             51       0.253315       0.229787          00:06
Better model found at epoch 52 with valid_loss value: 0.22814964968156867.
             52       0.250397       0.228150          00:06
             53       0.247546       0.228231          00:06
Better model found at epoch 54 with valid_loss value: 0.22604726000155823.
             54       0.245343       0.226047          00:06
Better model found at epoch 55 with valid_loss value: 0.22388508198286955.
             55       0.242899       0.223885          00:07
Better model found at epoch 56 with valid_loss value: 0.22236127456093172.
             56       0.239587       0.222361          00:06
Better model found at epoch 57 with valid_loss value: 0.2204447097864223.
             57       0.239170       0.220445          00:06
Better model found at epoch 58 with valid_loss value: 0.2202640095956651.
             58       0.236835       0.220264          00:06
Better model found at epoch 59 with valid_loss value: 0.22011543213793833.
             59       0.235676       0.220115          00:05
Better model found at epoch 60 with valid_loss value: 0.21744101826393358.
             60       0.233835       0.217441          00:05
Better model found at epoch 61 with valid_loss value: 0.2174100736262466.
             61       0.232573       0.217410          00:06
Better model found at epoch 62 with valid_loss value: 0.21568769823417644.
             62       0.231127       0.215688          00:06
             63       0.231128       0.215720          00:06
Better model found at epoch 64 with valid_loss value: 0.21493412954776217.
             64       0.230311       0.214934          00:06
             65       0.228901       0.216665          00:06
             66       0.228596       0.215712          00:06
Better model found at epoch 67 with valid_loss value: 0.2146062067089231.
             67       0.227628       0.214606          00:06
             68       0.226493       0.214610          00:07
Better model found at epoch 69 with valid_loss value: 0.2144857857299039.
             69       0.226091       0.214486          00:06
Better model found at epoch 70 with valid_loss value: 0.21362561904983313.
             70       0.225363       0.213626          00:06
             71       0.224399       0.213702          00:06
             72       0.224628       0.215012          00:07
Better model found at epoch 73 with valid_loss value: 0.21161358928266247.
             73       0.223765       0.211614          00:06
             74       0.223385       0.213379          00:07
             75       0.223316       0.212302          00:06
             76       0.222616       0.211669          00:07
             77       0.222037       0.213216          00:06
             78       0.221717       0.213164          00:06
No improvement since epoch 73: early stopping
pretraining completed
Model saved in: saved_models/DE/masked_patchtst/based_model/patchtst_pretrained_cw336_patch12_stride12_epochs-pretrain100_mask0.4_model1
Metrics saved in: saved_models/DE/masked_patchtst/based_model/patchtst_pretrained_cw336_patch12_stride12_epochs-pretrain100_mask0.4_model1_losses.csv
==========Running command for DE, pred_len 96:==========
args: Namespace(dset_pretrain='DE', context_points=512, target_points=96, batch_size=128, num_workers=0, features='M', patch_len=12, stride=12, revin=1, overlapping_windows=True, scaler_type='minmax', if_relu=False, n_layers=3, n_heads=16, d_model=128, d_ff=512, dropout=0.2, head_dropout=0.2, mask_ratio=0.4, n_epochs_pretrain=100, lr=0.0001, pretrained_model_id=1, model_type='based_model')
scaler_type: minmax overlapping_windows: True
number of patches: 42
number of model params 603404
suggested_lr 0.00017073526474706903
scaler_type: minmax overlapping_windows: True
number of patches: 42
number of model params 603404
          epoch     train_loss     valid_loss           time
Better model found at epoch 0 with valid_loss value: 0.9461362610608218.
              0       1.000957       0.946136          00:07
Better model found at epoch 1 with valid_loss value: 0.9346987992015866.
              1       0.958211       0.934699          00:07
Better model found at epoch 2 with valid_loss value: 0.931541220631611.
              2       0.945233       0.931541          00:07
Better model found at epoch 3 with valid_loss value: 0.9277373944772173.
              3       0.938388       0.927737          00:07
Better model found at epoch 4 with valid_loss value: 0.9253758454536208.
              4       0.931990       0.925376          00:07
Better model found at epoch 5 with valid_loss value: 0.9233688466232709.
              5       0.929744       0.923369          00:07
Better model found at epoch 6 with valid_loss value: 0.9231798114574857.
              6       0.927676       0.923180          00:07
Better model found at epoch 7 with valid_loss value: 0.9222467929973556.
              7       0.925632       0.922247          00:07
Better model found at epoch 8 with valid_loss value: 0.9219426998576078.
              8       0.923733       0.921943          00:07
Better model found at epoch 9 with valid_loss value: 0.9213271238049227.
              9       0.922350       0.921327          00:07
Better model found at epoch 10 with valid_loss value: 0.9211642309550447.
             10       0.921150       0.921164          00:07
Better model found at epoch 11 with valid_loss value: 0.9211291096674126.
             11       0.920864       0.921129          00:07
             12       0.920202       0.921193          00:07
Better model found at epoch 13 with valid_loss value: 0.9196049888120423.
             13       0.921127       0.919605          00:07
             14       0.919846       0.921145          00:07
Better model found at epoch 15 with valid_loss value: 0.9185357760374288.
             15       0.918814       0.918536          00:07
Better model found at epoch 16 with valid_loss value: 0.8934758632526444.
             16       0.917344       0.893476          00:07
Better model found at epoch 17 with valid_loss value: 0.6845567248525224.
             17       0.736549       0.684557          00:07
Better model found at epoch 18 with valid_loss value: 0.6729825919192433.
             18       0.698813       0.672983          00:07
Better model found at epoch 19 with valid_loss value: 0.6708966893816111.
             19       0.690645       0.670897          00:07
Better model found at epoch 20 with valid_loss value: 0.6684792800294955.
             20       0.686962       0.668479          00:07
Better model found at epoch 21 with valid_loss value: 0.663393248766782.
             21       0.684167       0.663393          00:07
Better model found at epoch 22 with valid_loss value: 0.5980447693119406.
             22       0.642384       0.598045          00:07
Better model found at epoch 23 with valid_loss value: 0.4846492559372457.
             23       0.577074       0.484649          00:07
Better model found at epoch 24 with valid_loss value: 0.3994392910267494.
             24       0.476427       0.399439          00:07
Better model found at epoch 25 with valid_loss value: 0.3792488017443043.
             25       0.433227       0.379249          00:07
Better model found at epoch 26 with valid_loss value: 0.3698520694543328.
             26       0.410985       0.369852          00:07
Better model found at epoch 27 with valid_loss value: 0.3672119339274817.
             27       0.396906       0.367212          00:07
Better model found at epoch 28 with valid_loss value: 0.3614170009280919.
             28       0.388391       0.361417          00:07
Better model found at epoch 29 with valid_loss value: 0.3577685983904597.
             29       0.381232       0.357769          00:07
Better model found at epoch 30 with valid_loss value: 0.3564025233294345.
             30       0.374823       0.356403          00:07
Better model found at epoch 31 with valid_loss value: 0.35267354842605775.
             31       0.368475       0.352674          00:07
Better model found at epoch 32 with valid_loss value: 0.3468402760120016.
             32       0.363041       0.346840          00:07
Better model found at epoch 33 with valid_loss value: 0.3443643046938568.
             33       0.357307       0.344364          00:07
Better model found at epoch 34 with valid_loss value: 0.33930691873474367.
             34       0.352686       0.339307          00:07
Better model found at epoch 35 with valid_loss value: 0.3323940640256306.
             35       0.346328       0.332394          00:07
Better model found at epoch 36 with valid_loss value: 0.32012227293531326.
             36       0.339068       0.320122          00:07
Better model found at epoch 37 with valid_loss value: 0.2536833251754475.
             37       0.318817       0.253683          00:07
Better model found at epoch 38 with valid_loss value: 0.24163187646206266.
             38       0.279200       0.241632          00:07
Better model found at epoch 39 with valid_loss value: 0.23491091747609846.
             39       0.263017       0.234911          00:07
Better model found at epoch 40 with valid_loss value: 0.23268452978793736.
             40       0.253943       0.232685          00:07
Better model found at epoch 41 with valid_loss value: 0.2255134303168226.
             41       0.243989       0.225513          00:07
Better model found at epoch 42 with valid_loss value: 0.22220767884840317.
             42       0.235982       0.222208          00:07
             43       0.230889       0.223801          00:07
             44       0.226268       0.223493          00:07
Better model found at epoch 45 with valid_loss value: 0.21801046646155411.
             45       0.223142       0.218010          00:07
             46       0.220206       0.222205          00:07
             47       0.217360       0.221675          00:07
             48       0.215597       0.219424          00:07
Better model found at epoch 49 with valid_loss value: 0.21707534231336453.
             49       0.213806       0.217075          00:07
             50       0.211905       0.217522          00:07
             51       0.210698       0.217281          00:07
             52       0.208657       0.218152          00:07
Better model found at epoch 53 with valid_loss value: 0.21551627895519732.
             53       0.207349       0.215516          00:07
             54       0.206594       0.217889          00:07
Better model found at epoch 55 with valid_loss value: 0.21504369104073434.
             55       0.205014       0.215044          00:07
             56       0.204426       0.217074          00:07
             57       0.203601       0.222093          00:07
             58       0.202517       0.219111          00:07
             59       0.201570       0.221795          00:07
             60       0.200720       0.215474          00:07
No improvement since epoch 55: early stopping
pretraining completed
Model saved in: saved_models/DE/masked_patchtst/based_model/patchtst_pretrained_cw512_patch12_stride12_epochs-pretrain100_mask0.4_model1
Metrics saved in: saved_models/DE/masked_patchtst/based_model/patchtst_pretrained_cw512_patch12_stride12_epochs-pretrain100_mask0.4_model1_losses.csv
==========Running command for DE, pred_len 168:==========
args: Namespace(dset_pretrain='DE', context_points=512, target_points=168, batch_size=128, num_workers=0, features='M', patch_len=12, stride=12, revin=1, overlapping_windows=True, scaler_type='minmax', if_relu=False, n_layers=3, n_heads=16, d_model=128, d_ff=512, dropout=0.2, head_dropout=0.2, mask_ratio=0.4, n_epochs_pretrain=100, lr=0.0001, pretrained_model_id=1, model_type='based_model')
scaler_type: minmax overlapping_windows: True
number of patches: 42
number of model params 603404
suggested_lr 0.000298364724028334
scaler_type: minmax overlapping_windows: True
number of patches: 42
number of model params 603404
          epoch     train_loss     valid_loss           time
Better model found at epoch 0 with valid_loss value: 0.9359786336551128.
              0       0.983682       0.935979          00:07
Better model found at epoch 1 with valid_loss value: 0.9328735090256052.
              1       0.945768       0.932874          00:07
Better model found at epoch 2 with valid_loss value: 0.9289134700981805.
              2       0.936567       0.928913          00:07
Better model found at epoch 3 with valid_loss value: 0.9257814108039684.
              3       0.931022       0.925781          00:07
Better model found at epoch 4 with valid_loss value: 0.9249027779207146.
              4       0.928205       0.924903          00:07
Better model found at epoch 5 with valid_loss value: 0.923622456724436.
              5       0.926251       0.923622          00:07
Better model found at epoch 6 with valid_loss value: 0.9196045283683929.
              6       0.924063       0.919605          00:07
              7       0.922906       0.921694          00:07
Better model found at epoch 8 with valid_loss value: 0.9195262168357896.
              8       0.922543       0.919526          00:07
              9       0.921097       0.921453          00:07
Better model found at epoch 10 with valid_loss value: 0.9189684682714474.
             10       0.920112       0.918968          00:07
             11       0.919243       0.922366          00:07
             12       0.918415       0.919047          00:07
Better model found at epoch 13 with valid_loss value: 0.7023705077803392.
             13       0.881433       0.702371          00:07
Better model found at epoch 14 with valid_loss value: 0.674443481586016.
             14       0.707539       0.674443          00:07
Better model found at epoch 15 with valid_loss value: 0.6730526880634571.
             15       0.691476       0.673053          00:07
Better model found at epoch 16 with valid_loss value: 0.66761510187253.
             16       0.687263       0.667615          00:07
Better model found at epoch 17 with valid_loss value: 0.6302513751955376.
             17       0.669674       0.630251          00:07
Better model found at epoch 18 with valid_loss value: 0.48802239581189283.
             18       0.586558       0.488022          00:07
Better model found at epoch 19 with valid_loss value: 0.3953361542637494.
             19       0.469851       0.395336          00:07
Better model found at epoch 20 with valid_loss value: 0.3721693275435328.
             20       0.422622       0.372169          00:07
Better model found at epoch 21 with valid_loss value: 0.36772792193674875.
             21       0.396300       0.367728          00:07
Better model found at epoch 22 with valid_loss value: 0.3619154212935328.
             22       0.382078       0.361915          00:07
Better model found at epoch 23 with valid_loss value: 0.3561038854741273.
             23       0.372167       0.356104          00:07
Better model found at epoch 24 with valid_loss value: 0.34986650054544705.
             24       0.363911       0.349867          00:07
Better model found at epoch 25 with valid_loss value: 0.341358764588136.
             25       0.357131       0.341359          00:07
Better model found at epoch 26 with valid_loss value: 0.24807859358276388.
             26       0.328177       0.248079          00:07
Better model found at epoch 27 with valid_loss value: 0.23241851821715998.
             27       0.268724       0.232419          00:07
Better model found at epoch 28 with valid_loss value: 0.22971355426297752.
             28       0.249302       0.229714          00:07
             29       0.238270       0.233655          00:07
Better model found at epoch 30 with valid_loss value: 0.22232555663901696.
             30       0.230443       0.222326          00:07
Better model found at epoch 31 with valid_loss value: 0.21842386945161987.
             31       0.224471       0.218424          00:07
             32       0.219179       0.219963          00:07
             33       0.214807       0.219522          00:07
             34       0.210876       0.220609          00:07
             35       0.208398       0.221050          00:07
             36       0.205657       0.220657          00:07
Better model found at epoch 37 with valid_loss value: 0.21784742742595298.
             37       0.203153       0.217847          00:07
             38       0.200946       0.218997          00:07
             39       0.199741       0.220684          00:07
Better model found at epoch 40 with valid_loss value: 0.2132192480098901.
             40       0.197786       0.213219          00:07
             41       0.196141       0.224197          00:07
             42       0.194673       0.217961          00:07
             43       0.193609       0.226020          00:07
             44       0.192840       0.219912          00:07
             45       0.191634       0.217838          00:07
No improvement since epoch 40: early stopping
pretraining completed
Model saved in: saved_models/DE/masked_patchtst/based_model/patchtst_pretrained_cw512_patch12_stride12_epochs-pretrain100_mask0.4_model1
Metrics saved in: saved_models/DE/masked_patchtst/based_model/patchtst_pretrained_cw512_patch12_stride12_epochs-pretrain100_mask0.4_model1_losses.csv
==========Running command for GB, pred_len 24:==========
args: Namespace(dset_pretrain='GB', context_points=512, target_points=24, batch_size=128, num_workers=0, features='M', patch_len=12, stride=12, revin=1, overlapping_windows=True, scaler_type='minmax', if_relu=False, n_layers=3, n_heads=16, d_model=128, d_ff=512, dropout=0.2, head_dropout=0.2, mask_ratio=0.4, n_epochs_pretrain=100, lr=0.0001, pretrained_model_id=1, model_type='based_model')
scaler_type: minmax overlapping_windows: True
number of patches: 42
number of model params 603404
suggested_lr 0.00020565123083486514
scaler_type: minmax overlapping_windows: True
number of patches: 42
number of model params 603404
          epoch     train_loss     valid_loss           time
Better model found at epoch 0 with valid_loss value: 0.9467888890843654.
              0       0.994012       0.946789          00:07
Better model found at epoch 1 with valid_loss value: 0.9346246619651761.
              1       0.952766       0.934625          00:07
Better model found at epoch 2 with valid_loss value: 0.931747753136561.
              2       0.941247       0.931748          00:07
Better model found at epoch 3 with valid_loss value: 0.9293389408577288.
              3       0.934662       0.929339          00:07
Better model found at epoch 4 with valid_loss value: 0.9284990374175648.
              4       0.930642       0.928499          00:07
Better model found at epoch 5 with valid_loss value: 0.9236947646071256.
              5       0.926743       0.923695          00:07
Better model found at epoch 6 with valid_loss value: 0.9235418478315506.
              6       0.924759       0.923542          00:07
              7       0.920984       0.924588          00:07
Better model found at epoch 8 with valid_loss value: 0.9209615048707174.
              8       0.920547       0.920962          00:07
              9       0.919426       0.923873          00:07
             10       0.919090       0.922315          00:07
             11       0.918223       0.921985          00:07
Better model found at epoch 12 with valid_loss value: 0.9207974354592247.
             12       0.917472       0.920797          00:07
Better model found at epoch 13 with valid_loss value: 0.9191660090276661.
             13       0.917691       0.919166          00:07
             14       0.917141       0.919694          00:07
Better model found at epoch 15 with valid_loss value: 0.7061174407119591.
             15       0.898495       0.706117          00:07
Better model found at epoch 16 with valid_loss value: 0.6600779459295077.
             16       0.674583       0.660078          00:07
Better model found at epoch 17 with valid_loss value: 0.6519863158728084.
             17       0.657217       0.651986          00:07
Better model found at epoch 18 with valid_loss value: 0.647168691315144.
             18       0.649750       0.647169          00:07
Better model found at epoch 19 with valid_loss value: 0.6462094860865369.
             19       0.646174       0.646209          00:07
Better model found at epoch 20 with valid_loss value: 0.6445758605436706.
             20       0.643086       0.644576          00:07
             21       0.641331       0.645169          00:07
Better model found at epoch 22 with valid_loss value: 0.6444223547204239.
             22       0.640616       0.644422          00:07
Better model found at epoch 23 with valid_loss value: 0.6177768618304649.
             23       0.634769       0.617777          00:07
Better model found at epoch 24 with valid_loss value: 0.5525442304115731.
             24       0.588757       0.552544          00:07
Better model found at epoch 25 with valid_loss value: 0.44780401457193986.
             25       0.519237       0.447804          00:07
Better model found at epoch 26 with valid_loss value: 0.40279841626286794.
             26       0.433012       0.402798          00:07
Better model found at epoch 27 with valid_loss value: 0.38611187381876305.
             27       0.402954       0.386112          00:07
Better model found at epoch 28 with valid_loss value: 0.3806210463120275.
             28       0.387050       0.380621          00:07
Better model found at epoch 29 with valid_loss value: 0.37572445009650957.
             29       0.377550       0.375724          00:07
Better model found at epoch 30 with valid_loss value: 0.3730382749039931.
             30       0.370962       0.373038          00:07
Better model found at epoch 31 with valid_loss value: 0.3686332193355919.
             31       0.365199       0.368633          00:07
Better model found at epoch 32 with valid_loss value: 0.36194100946748836.
             32       0.360882       0.361941          00:07
Better model found at epoch 33 with valid_loss value: 0.287373994849053.
             33       0.342453       0.287374          00:07
Better model found at epoch 34 with valid_loss value: 0.2783686929487695.
             34       0.288385       0.278369          00:07
Better model found at epoch 35 with valid_loss value: 0.27110314334687147.
             35       0.273790       0.271103          00:07
Better model found at epoch 36 with valid_loss value: 0.2663853034647941.
             36       0.266314       0.266385          00:07
Better model found at epoch 37 with valid_loss value: 0.26261608558815547.
             37       0.260101       0.262616          00:07
Better model found at epoch 38 with valid_loss value: 0.2574882292567255.
             38       0.254531       0.257488          00:07
Better model found at epoch 39 with valid_loss value: 0.25257961646870475.
             39       0.249111       0.252580          00:07
Better model found at epoch 40 with valid_loss value: 0.24821979976149067.
             40       0.244952       0.248220          00:07
Better model found at epoch 41 with valid_loss value: 0.24734842154073508.
             41       0.240456       0.247348          00:07
Better model found at epoch 42 with valid_loss value: 0.2451266318976697.
             42       0.236499       0.245127          00:07
Better model found at epoch 43 with valid_loss value: 0.24243739365726033.
             43       0.233125       0.242437          00:07
Better model found at epoch 44 with valid_loss value: 0.24043708593875662.
             44       0.230439       0.240437          00:07
Better model found at epoch 45 with valid_loss value: 0.23935789169942295.
             45       0.228508       0.239358          00:07
             46       0.227602       0.239896          00:07
             47       0.225281       0.239593          00:07
Better model found at epoch 48 with valid_loss value: 0.23675624484779637.
             48       0.224134       0.236756          00:07
             49       0.223008       0.240341          00:07
Better model found at epoch 50 with valid_loss value: 0.2365359606535005.
             50       0.222534       0.236536          00:07
             51       0.221029       0.239006          00:07
Better model found at epoch 52 with valid_loss value: 0.23606827643708783.
             52       0.220644       0.236068          00:07
             53       0.219387       0.236221          00:07
Better model found at epoch 54 with valid_loss value: 0.23581528046208983.
             54       0.218708       0.235815          00:07
             55       0.218181       0.238401          00:07
             56       0.217755       0.236449          00:07
             57       0.216821       0.237277          00:07
             58       0.216666       0.239222          00:07
             59       0.215375       0.236557          00:07
No improvement since epoch 54: early stopping
pretraining completed
Model saved in: saved_models/GB/masked_patchtst/based_model/patchtst_pretrained_cw512_patch12_stride12_epochs-pretrain100_mask0.4_model1
Metrics saved in: saved_models/GB/masked_patchtst/based_model/patchtst_pretrained_cw512_patch12_stride12_epochs-pretrain100_mask0.4_model1_losses.csv
==========Running command for GB, pred_len 96:==========
args: Namespace(dset_pretrain='GB', context_points=512, target_points=96, batch_size=128, num_workers=0, features='M', patch_len=12, stride=12, revin=1, overlapping_windows=True, scaler_type='minmax', if_relu=False, n_layers=3, n_heads=16, d_model=128, d_ff=512, dropout=0.2, head_dropout=0.2, mask_ratio=0.4, n_epochs_pretrain=100, lr=0.0001, pretrained_model_id=1, model_type='based_model')
scaler_type: minmax overlapping_windows: True
number of patches: 42
number of model params 603404
suggested_lr 0.00020565123083486514
scaler_type: minmax overlapping_windows: True
number of patches: 42
number of model params 603404
          epoch     train_loss     valid_loss           time
Better model found at epoch 0 with valid_loss value: 0.9472319339910497.
              0       0.994241       0.947232          00:07
Better model found at epoch 1 with valid_loss value: 0.9348513622609845.
              1       0.952952       0.934851          00:07
Better model found at epoch 2 with valid_loss value: 0.9318040740693654.
              2       0.941092       0.931804          00:07
Better model found at epoch 3 with valid_loss value: 0.9280132793429617.
              3       0.934617       0.928013          00:07
              4       0.930872       0.928395          00:07
Better model found at epoch 5 with valid_loss value: 0.9265261073535395.
              5       0.927245       0.926526          00:07
Better model found at epoch 6 with valid_loss value: 0.9217118687703417.
              6       0.923804       0.921712          00:07
              7       0.922645       0.921735          00:07
Better model found at epoch 8 with valid_loss value: 0.9215749593165175.
              8       0.920516       0.921575          00:07
              9       0.919884       0.922022          00:07
             10       0.919163       0.921664          00:07
             11       0.919222       0.923206          00:07
             12       0.917737       0.921869          00:07
             13       0.917850       0.922028          00:07
Better model found at epoch 14 with valid_loss value: 0.9205653414869813.
             14       0.917120       0.920565          00:07
             15       0.917794       0.920677          00:07
Better model found at epoch 16 with valid_loss value: 0.6673912352522376.
             16       0.766252       0.667391          00:07
Better model found at epoch 17 with valid_loss value: 0.6538016012764443.
             17       0.660656       0.653802          00:07
Better model found at epoch 18 with valid_loss value: 0.6485590736879577.
             18       0.651177       0.648559          00:07
Better model found at epoch 19 with valid_loss value: 0.6468859654698942.
             19       0.646764       0.646886          00:07
Better model found at epoch 20 with valid_loss value: 0.6448534202730879.
             20       0.643529       0.644853          00:07
             21       0.642178       0.645078          00:07
Better model found at epoch 22 with valid_loss value: 0.6446524263883239.
             22       0.640534       0.644652          00:07
Better model found at epoch 23 with valid_loss value: 0.6287641359209724.
             23       0.638677       0.628764          00:07
Better model found at epoch 24 with valid_loss value: 0.5574933889340927.
             24       0.594895       0.557493          00:07
Better model found at epoch 25 with valid_loss value: 0.4533323506789056.
             25       0.527430       0.453332          00:07
Better model found at epoch 26 with valid_loss value: 0.3936196062601709.
             26       0.429555       0.393620          00:07
Better model found at epoch 27 with valid_loss value: 0.3834495699628763.
             27       0.399745       0.383450          00:07
Better model found at epoch 28 with valid_loss value: 0.3818345866812449.
             28       0.387066       0.381835          00:07
Better model found at epoch 29 with valid_loss value: 0.3754607483853743.
             29       0.379008       0.375461          00:07
Better model found at epoch 30 with valid_loss value: 0.37412157050956063.
             30       0.372021       0.374122          00:07
Better model found at epoch 31 with valid_loss value: 0.36980467160801467.
             31       0.367399       0.369805          00:07
Better model found at epoch 32 with valid_loss value: 0.36502452133340113.
             32       0.362389       0.365025          00:07
Better model found at epoch 33 with valid_loss value: 0.36197929909987797.
             33       0.358876       0.361979          00:07
Better model found at epoch 34 with valid_loss value: 0.3607122311076078.
             34       0.355642       0.360712          00:07
Better model found at epoch 35 with valid_loss value: 0.35801627498220095.
             35       0.352055       0.358016          00:07
Better model found at epoch 36 with valid_loss value: 0.35255054445941825.
             36       0.347909       0.352551          00:07
Better model found at epoch 37 with valid_loss value: 0.3428180939788446.
             37       0.343212       0.342818          00:07
Better model found at epoch 38 with valid_loss value: 0.3012551490032547.
             38       0.332112       0.301255          00:07
Better model found at epoch 39 with valid_loss value: 0.26763221734514847.
             39       0.288832       0.267632          00:07
Better model found at epoch 40 with valid_loss value: 0.258781374752085.
             40       0.267665       0.258781          00:07
Better model found at epoch 41 with valid_loss value: 0.25558366891909073.
             41       0.258717       0.255584          00:07
Better model found at epoch 42 with valid_loss value: 0.2531909318742372.
             42       0.252676       0.253191          00:07
Better model found at epoch 43 with valid_loss value: 0.2477449471432567.
             43       0.248053       0.247745          00:07
             44       0.242647       0.249967          00:07
Better model found at epoch 45 with valid_loss value: 0.2458815919955248.
             45       0.238316       0.245882          00:07
Better model found at epoch 46 with valid_loss value: 0.24555082018536412.
             46       0.234635       0.245551          00:07
Better model found at epoch 47 with valid_loss value: 0.24120416354124288.
             47       0.232463       0.241204          00:07
             48       0.230289       0.241865          00:07
             49       0.227923       0.244935          00:07
             50       0.226405       0.242942          00:07
             51       0.224754       0.243288          00:07
             52       0.223587       0.243286          00:07
No improvement since epoch 47: early stopping
pretraining completed
Model saved in: saved_models/GB/masked_patchtst/based_model/patchtst_pretrained_cw512_patch12_stride12_epochs-pretrain100_mask0.4_model1
Metrics saved in: saved_models/GB/masked_patchtst/based_model/patchtst_pretrained_cw512_patch12_stride12_epochs-pretrain100_mask0.4_model1_losses.csv
==========Running command for GB, pred_len 168:==========
args: Namespace(dset_pretrain='GB', context_points=512, target_points=168, batch_size=128, num_workers=0, features='M', patch_len=12, stride=12, revin=1, overlapping_windows=True, scaler_type='minmax', if_relu=False, n_layers=3, n_heads=16, d_model=128, d_ff=512, dropout=0.2, head_dropout=0.2, mask_ratio=0.4, n_epochs_pretrain=100, lr=0.0001, pretrained_model_id=1, model_type='based_model')
scaler_type: minmax overlapping_windows: True
number of patches: 42
number of model params 603404
suggested_lr 0.0002477076355991711
scaler_type: minmax overlapping_windows: True
number of patches: 42
number of model params 603404
          epoch     train_loss     valid_loss           time
Better model found at epoch 0 with valid_loss value: 0.9421158779124815.
              0       0.988103       0.942116          00:07
Better model found at epoch 1 with valid_loss value: 0.9335727650821258.
              1       0.948592       0.933573          00:07
Better model found at epoch 2 with valid_loss value: 0.9298113190556562.
              2       0.937972       0.929811          00:07
Better model found at epoch 3 with valid_loss value: 0.927793309654413.
              3       0.931911       0.927793          00:07
Better model found at epoch 4 with valid_loss value: 0.9258069786349415.
              4       0.928056       0.925807          00:07
Better model found at epoch 5 with valid_loss value: 0.9238495923297794.
              5       0.925643       0.923850          00:07
              6       0.923033       0.924933          00:07
              7       0.921442       0.924919          00:07
Better model found at epoch 8 with valid_loss value: 0.9218602060349086.
              8       0.920174       0.921860          00:07
Better model found at epoch 9 with valid_loss value: 0.9216753618732505.
              9       0.919832       0.921675          00:07
Better model found at epoch 10 with valid_loss value: 0.9206957440978512.
             10       0.918717       0.920696          00:07
Better model found at epoch 11 with valid_loss value: 0.9205497340945579.
             11       0.917999       0.920550          00:07
             12       0.917857       0.920947          00:07
             13       0.916878       0.921548          00:07
             14       0.917202       0.921196          00:07
Better model found at epoch 15 with valid_loss value: 0.6626541386438951.
             15       0.761868       0.662654          00:07
Better model found at epoch 16 with valid_loss value: 0.6507098208772435.
             16       0.658344       0.650710          00:07
Better model found at epoch 17 with valid_loss value: 0.6462436916603203.
             17       0.649452       0.646244          00:07
Better model found at epoch 18 with valid_loss value: 0.6462387871392845.
             18       0.645095       0.646239          00:07
Better model found at epoch 19 with valid_loss value: 0.6451942447616499.
             19       0.643565       0.645194          00:07
Better model found at epoch 20 with valid_loss value: 0.6425860847964351.
             20       0.640541       0.642586          00:07
Better model found at epoch 21 with valid_loss value: 0.5760350308229046.
             21       0.619216       0.576035          00:07
Better model found at epoch 22 with valid_loss value: 0.4773536153234604.
             22       0.534733       0.477354          00:07
Better model found at epoch 23 with valid_loss value: 0.4057669448789725.
             23       0.447149       0.405767          00:07
Better model found at epoch 24 with valid_loss value: 0.38563151416875924.
             24       0.404997       0.385632          00:07
Better model found at epoch 25 with valid_loss value: 0.3793672347763667.
             25       0.388318       0.379367          00:07
Better model found at epoch 26 with valid_loss value: 0.29737510034167625.
             26       0.358118       0.297375          00:07
Better model found at epoch 27 with valid_loss value: 0.2842147628656039.
             27       0.306254       0.284215          00:07
Better model found at epoch 28 with valid_loss value: 0.28086298504909024.
             28       0.288725       0.280863          00:07
Better model found at epoch 29 with valid_loss value: 0.2728999926351782.
             29       0.279030       0.272900          00:07
Better model found at epoch 30 with valid_loss value: 0.2689227476831364.
             30       0.272212       0.268923          00:07
Better model found at epoch 31 with valid_loss value: 0.2643285381053948.
             31       0.267228       0.264329          00:07
Better model found at epoch 32 with valid_loss value: 0.26234019703631856.
             32       0.261975       0.262340          00:07
Better model found at epoch 33 with valid_loss value: 0.258537384188982.
             33       0.256240       0.258537          00:07
             34       0.251831       0.259425          00:07
Better model found at epoch 35 with valid_loss value: 0.25511991795138317.
             35       0.247655       0.255120          00:07
Better model found at epoch 36 with valid_loss value: 0.25297883321283754.
             36       0.244411       0.252979          00:07
Better model found at epoch 37 with valid_loss value: 0.25297071261243415.
             37       0.242079       0.252971          00:07
Better model found at epoch 38 with valid_loss value: 0.24702074467674542.
             38       0.238749       0.247021          00:07
Better model found at epoch 39 with valid_loss value: 0.24277491689650915.
             39       0.236296       0.242775          00:07
Better model found at epoch 40 with valid_loss value: 0.24212569097465214.
             40       0.232424       0.242126          00:07
Better model found at epoch 41 with valid_loss value: 0.2404334905138523.
             41       0.229201       0.240433          00:07
             42       0.226668       0.240528          00:07
Better model found at epoch 43 with valid_loss value: 0.23769262707372799.
             43       0.224943       0.237693          00:07
Better model found at epoch 44 with valid_loss value: 0.23606913010842046.
             44       0.223360       0.236069          00:07
Better model found at epoch 45 with valid_loss value: 0.23520701983291825.
             45       0.222293       0.235207          00:07
             46       0.220825       0.236967          00:07
             47       0.220237       0.236222          00:07
             48       0.219034       0.240438          00:07
             49       0.217438       0.240547          00:07
             50       0.217513       0.238286          00:07
No improvement since epoch 45: early stopping
pretraining completed
Model saved in: saved_models/GB/masked_patchtst/based_model/patchtst_pretrained_cw512_patch12_stride12_epochs-pretrain100_mask0.4_model1
Metrics saved in: saved_models/GB/masked_patchtst/based_model/patchtst_pretrained_cw512_patch12_stride12_epochs-pretrain100_mask0.4_model1_losses.csv
==========Running command for ES, pred_len 24:==========
args: Namespace(dset_pretrain='ES', context_points=336, target_points=24, batch_size=128, num_workers=0, features='M', patch_len=12, stride=12, revin=1, overlapping_windows=True, scaler_type='minmax', if_relu=False, n_layers=3, n_heads=16, d_model=128, d_ff=512, dropout=0.2, head_dropout=0.2, mask_ratio=0.4, n_epochs_pretrain=100, lr=0.0001, pretrained_model_id=1, model_type='based_model')
scaler_type: minmax overlapping_windows: True
number of patches: 28
number of model params 601612
suggested_lr 0.00020565123083486514
scaler_type: minmax overlapping_windows: True
number of patches: 28
number of model params 601612
          epoch     train_loss     valid_loss           time
Better model found at epoch 0 with valid_loss value: 0.9106508144251648.
              0       0.974847       0.910651          00:06
Better model found at epoch 1 with valid_loss value: 0.8942057029867702.
              1       0.919490       0.894206          00:06
Better model found at epoch 2 with valid_loss value: 0.8881760539398021.
              2       0.897588       0.888176          00:06
Better model found at epoch 3 with valid_loss value: 0.8804428790262586.
              3       0.886993       0.880443          00:06
              4       0.882118       0.880538          00:07
Better model found at epoch 5 with valid_loss value: 0.8771754708611469.
              5       0.876388       0.877175          00:07
              6       0.874268       0.878591          00:07
Better model found at epoch 7 with valid_loss value: 0.8752079730979572.
              7       0.871197       0.875208          00:06
              8       0.868928       0.876438          00:05
Better model found at epoch 9 with valid_loss value: 0.8729755609618787.
              9       0.867896       0.872976          00:04
             10       0.866915       0.876907          00:04
             11       0.865574       0.873063          00:04
             12       0.865753       0.873675          00:04
             13       0.863410       0.873389          00:06
             14       0.862938       0.873921          00:06
No improvement since epoch 9: early stopping
pretraining completed
Model saved in: saved_models/ES/masked_patchtst/based_model/patchtst_pretrained_cw336_patch12_stride12_epochs-pretrain100_mask0.4_model1
Metrics saved in: saved_models/ES/masked_patchtst/based_model/patchtst_pretrained_cw336_patch12_stride12_epochs-pretrain100_mask0.4_model1_losses.csv
==========Running command for ES, pred_len 96:==========
args: Namespace(dset_pretrain='ES', context_points=336, target_points=96, batch_size=128, num_workers=0, features='M', patch_len=12, stride=12, revin=1, overlapping_windows=True, scaler_type='minmax', if_relu=False, n_layers=3, n_heads=16, d_model=128, d_ff=512, dropout=0.2, head_dropout=0.2, mask_ratio=0.4, n_epochs_pretrain=100, lr=0.0001, pretrained_model_id=1, model_type='based_model')
scaler_type: minmax overlapping_windows: True
number of patches: 28
number of model params 601612
suggested_lr 0.00020565123083486514
scaler_type: minmax overlapping_windows: True
number of patches: 28
number of model params 601612
          epoch     train_loss     valid_loss           time
Better model found at epoch 0 with valid_loss value: 0.9099702343114321.
              0       0.974942       0.909970          00:06
Better model found at epoch 1 with valid_loss value: 0.893052580222742.
              1       0.918080       0.893053          00:06
Better model found at epoch 2 with valid_loss value: 0.8856189451535802.
              2       0.899571       0.885619          00:06
Better model found at epoch 3 with valid_loss value: 0.881366965012205.
              3       0.887471       0.881367          00:06
              4       0.881560       0.881604          00:06
Better model found at epoch 5 with valid_loss value: 0.8769896765663141.
              5       0.878391       0.876990          00:06
Better model found at epoch 6 with valid_loss value: 0.8754573713384866.
              6       0.873963       0.875457          00:06
Better model found at epoch 7 with valid_loss value: 0.8744336096419854.
              7       0.871417       0.874434          00:05
              8       0.868752       0.875876          00:06
              9       0.867785       0.876078          00:06
Better model found at epoch 10 with valid_loss value: 0.8728817572721725.
             10       0.866980       0.872882          00:06
             11       0.865893       0.873384          00:06
Better model found at epoch 12 with valid_loss value: 0.8726084151240846.
             12       0.863778       0.872608          00:06
             13       0.864219       0.874411          00:06
Better model found at epoch 14 with valid_loss value: 0.8723680488456061.
             14       0.862497       0.872368          00:06
             15       0.862756       0.872919          00:06
Better model found at epoch 16 with valid_loss value: 0.45055904031478844.
             16       0.672252       0.450559          00:06
Better model found at epoch 17 with valid_loss value: 0.43138059238964604.
             17       0.482882       0.431381          00:06
Better model found at epoch 18 with valid_loss value: 0.42596090889442634.
             18       0.469813       0.425961          00:06
             19       0.463695       0.427612          00:06
Better model found at epoch 20 with valid_loss value: 0.42418049004526037.
             20       0.460189       0.424180          00:06
             21       0.458764       0.424235          00:06
Better model found at epoch 22 with valid_loss value: 0.4232986040480065.
             22       0.455921       0.423299          00:06
             23       0.454422       0.423410          00:06
Better model found at epoch 24 with valid_loss value: 0.41979839427379984.
             24       0.453985       0.419798          00:06
Better model found at epoch 25 with valid_loss value: 0.3493938002186737.
             25       0.415751       0.349394          00:06
Better model found at epoch 26 with valid_loss value: 0.3040582568399105.
             26       0.376374       0.304058          00:06
Better model found at epoch 27 with valid_loss value: 0.23271883661132017.
             27       0.327226       0.232719          00:06
Better model found at epoch 28 with valid_loss value: 0.17877049271511392.
             28       0.263951       0.178770          00:06
Better model found at epoch 29 with valid_loss value: 0.16472927804299736.
             29       0.226499       0.164729          00:06
Better model found at epoch 30 with valid_loss value: 0.1547522300428448.
             30       0.209905       0.154752          00:06
Better model found at epoch 31 with valid_loss value: 0.15323173454663344.
             31       0.200093       0.153232          00:06
Better model found at epoch 32 with valid_loss value: 0.14568125365515663.
             32       0.193592       0.145681          00:06
Better model found at epoch 33 with valid_loss value: 0.14227358489816416.
             33       0.188888       0.142274          00:07
             34       0.184273       0.145739          00:06
Better model found at epoch 35 with valid_loss value: 0.13625480335257323.
             35       0.180067       0.136255          00:06
Better model found at epoch 36 with valid_loss value: 0.1335450112674176.
             36       0.177082       0.133545          00:06
             37       0.174404       0.133571          00:06
Better model found at epoch 38 with valid_loss value: 0.13108398834799634.
             38       0.171822       0.131084          00:06
Better model found at epoch 39 with valid_loss value: 0.12891647053308075.
             39       0.169497       0.128916          00:07
Better model found at epoch 40 with valid_loss value: 0.1265960916840419.
             40       0.166590       0.126596          00:06
Better model found at epoch 41 with valid_loss value: 0.1248662192807923.
             41       0.163877       0.124866          00:06
Better model found at epoch 42 with valid_loss value: 0.12363120343648291.
             42       0.161782       0.123631          00:07
Better model found at epoch 43 with valid_loss value: 0.11950864365083401.
             43       0.158475       0.119509          00:06
Better model found at epoch 44 with valid_loss value: 0.11705404705299023.
             44       0.155944       0.117054          00:06
Better model found at epoch 45 with valid_loss value: 0.11574927532546786.
             45       0.154136       0.115749          00:06
Better model found at epoch 46 with valid_loss value: 0.11367551029164971.
             46       0.151031       0.113676          00:06
Better model found at epoch 47 with valid_loss value: 0.11163314186139646.
             47       0.148374       0.111633          00:06
Better model found at epoch 48 with valid_loss value: 0.11136423953671684.
             48       0.146442       0.111364          00:06
Better model found at epoch 49 with valid_loss value: 0.10818756078684398.
             49       0.144983       0.108188          00:06
Better model found at epoch 50 with valid_loss value: 0.1080408678295362.
             50       0.143104       0.108041          00:06
Better model found at epoch 51 with valid_loss value: 0.1070815183361727.
             51       0.141803       0.107082          00:06
Better model found at epoch 52 with valid_loss value: 0.10599083151634968.
             52       0.140398       0.105991          00:04
Better model found at epoch 53 with valid_loss value: 0.10575469647897172.
             53       0.139013       0.105755          00:06
             54       0.138314       0.105882          00:06
Better model found at epoch 55 with valid_loss value: 0.10294352345974878.
             55       0.137232       0.102944          00:06
Better model found at epoch 56 with valid_loss value: 0.10274188396307973.
             56       0.136034       0.102742          00:05
Better model found at epoch 57 with valid_loss value: 0.10200487327730878.
             57       0.134766       0.102005          00:06
Better model found at epoch 58 with valid_loss value: 0.10157757752110455.
             58       0.133977       0.101578          00:06
Better model found at epoch 59 with valid_loss value: 0.10108636618630493.
             59       0.134107       0.101086          00:06
             60       0.133250       0.102354          00:06
             61       0.132855       0.102556          00:06
Better model found at epoch 62 with valid_loss value: 0.10021602174341436.
             62       0.132256       0.100216          00:06
             63       0.131536       0.101225          00:06
             64       0.131495       0.100287          00:06
Better model found at epoch 65 with valid_loss value: 0.09958967887065195.
             65       0.129906       0.099590          00:06
             66       0.130154       0.099722          00:06
             67       0.129490       0.100253          00:06
Better model found at epoch 68 with valid_loss value: 0.09816647212227929.
             68       0.129321       0.098166          00:06
             69       0.128788       0.100288          00:06
             70       0.128647       0.100424          00:06
             71       0.128517       0.098898          00:06
             72       0.128276       0.100212          00:06
             73       0.127677       0.098651          00:06
No improvement since epoch 68: early stopping
pretraining completed
Model saved in: saved_models/ES/masked_patchtst/based_model/patchtst_pretrained_cw336_patch12_stride12_epochs-pretrain100_mask0.4_model1
Metrics saved in: saved_models/ES/masked_patchtst/based_model/patchtst_pretrained_cw336_patch12_stride12_epochs-pretrain100_mask0.4_model1_losses.csv
==========Running command for ES, pred_len 168:==========
args: Namespace(dset_pretrain='ES', context_points=336, target_points=168, batch_size=128, num_workers=0, features='M', patch_len=12, stride=12, revin=1, overlapping_windows=True, scaler_type='minmax', if_relu=False, n_layers=3, n_heads=16, d_model=128, d_ff=512, dropout=0.2, head_dropout=0.2, mask_ratio=0.4, n_epochs_pretrain=100, lr=0.0001, pretrained_model_id=1, model_type='based_model')
scaler_type: minmax overlapping_windows: True
number of patches: 28
number of model params 601612
suggested_lr 0.000298364724028334
scaler_type: minmax overlapping_windows: True
number of patches: 28
number of model params 601612
          epoch     train_loss     valid_loss           time
Better model found at epoch 0 with valid_loss value: 0.9014324739111642.
              0       0.959675       0.901432          00:05
Better model found at epoch 1 with valid_loss value: 0.8885724981475382.
              1       0.906642       0.888572          00:06
Better model found at epoch 2 with valid_loss value: 0.8836231932066112.
              2       0.889131       0.883623          00:06
Better model found at epoch 3 with valid_loss value: 0.8798330436717849.
              3       0.881382       0.879833          00:06
Better model found at epoch 4 with valid_loss value: 0.8784155566904742.
              4       0.876183       0.878416          00:06
Better model found at epoch 5 with valid_loss value: 0.8781204010065042.
              5       0.872437       0.878120          00:06
Better model found at epoch 6 with valid_loss value: 0.8776921800386959.
              6       0.870993       0.877692          00:06
Better model found at epoch 7 with valid_loss value: 0.875666371644986.
              7       0.868498       0.875666          00:06
              8       0.867715       0.876762          00:06
Better model found at epoch 9 with valid_loss value: 0.8744772262987814.
              9       0.865525       0.874477          00:06
             10       0.864965       0.874754          00:06
Better model found at epoch 11 with valid_loss value: 0.8736491662635847.
             11       0.864361       0.873649          00:06
Better model found at epoch 12 with valid_loss value: 0.8733627743958916.
             12       0.863195       0.873363          00:06
             13       0.863664       0.873691          00:04
Better model found at epoch 14 with valid_loss value: 0.44501621868825125.
             14       0.634622       0.445016          00:05
Better model found at epoch 15 with valid_loss value: 0.42973425375380786.
             15       0.477598       0.429734          00:06
Better model found at epoch 16 with valid_loss value: 0.4279624352281615.
             16       0.466770       0.427962          00:06
Better model found at epoch 17 with valid_loss value: 0.4236934516764779.
             17       0.460934       0.423693          00:04
Better model found at epoch 18 with valid_loss value: 0.42330639652457597.
             18       0.457620       0.423306          00:04
Better model found at epoch 19 with valid_loss value: 0.42088525157459244.
             19       0.455942       0.420885          00:03
Better model found at epoch 20 with valid_loss value: 0.3868522574947514.
             20       0.452120       0.386852          00:03
Better model found at epoch 21 with valid_loss value: 0.3334017822225424.
             21       0.402889       0.333402          00:05
Better model found at epoch 22 with valid_loss value: 0.2267317260762288.
             22       0.330489       0.226732          00:06
Better model found at epoch 23 with valid_loss value: 0.21433631297726619.
             23       0.276763       0.214336          00:06
Better model found at epoch 24 with valid_loss value: 0.208926264465925.
             24       0.262341       0.208926          00:06
Better model found at epoch 25 with valid_loss value: 0.2021825882427857.
             25       0.254994       0.202183          00:06
Better model found at epoch 26 with valid_loss value: 0.20160578440818994.
             26       0.248311       0.201606          00:06
Better model found at epoch 27 with valid_loss value: 0.1630751937848623.
             27       0.229436       0.163075          00:06
Better model found at epoch 28 with valid_loss value: 0.14907761034689918.
             28       0.208076       0.149078          00:06
Better model found at epoch 29 with valid_loss value: 0.1447995916222419.
             29       0.197636       0.144800          00:06
Better model found at epoch 30 with valid_loss value: 0.13855760367996667.
             30       0.189221       0.138558          00:06
Better model found at epoch 31 with valid_loss value: 0.1357648508092942.
             31       0.181764       0.135765          00:06
Better model found at epoch 32 with valid_loss value: 0.13042704348074985.
             32       0.176287       0.130427          00:05
             33       0.171566       0.131045          00:06
Better model found at epoch 34 with valid_loss value: 0.1253122009046188.
             34       0.168228       0.125312          00:04
Better model found at epoch 35 with valid_loss value: 0.12194033264230508.
             35       0.164039       0.121940          00:05
Better model found at epoch 36 with valid_loss value: 0.11991341872131257.
             36       0.160693       0.119913          00:04
Better model found at epoch 37 with valid_loss value: 0.11732120849971184.
             37       0.157042       0.117321          00:05
Better model found at epoch 38 with valid_loss value: 0.11647668615825169.
             38       0.153194       0.116477          00:06
Better model found at epoch 39 with valid_loss value: 0.11245367237670838.
             39       0.150547       0.112454          00:06
Better model found at epoch 40 with valid_loss value: 0.11175565250069468.
             40       0.146879       0.111756          00:06
Better model found at epoch 41 with valid_loss value: 0.10580922225231043.
             41       0.144466       0.105809          00:06
             42       0.141895       0.108074          00:06
Better model found at epoch 43 with valid_loss value: 0.10555038816469928.
             43       0.139967       0.105550          00:06
Better model found at epoch 44 with valid_loss value: 0.10491967479970257.
             44       0.138643       0.104920          00:06
             45       0.136853       0.105247          00:06
Better model found at epoch 46 with valid_loss value: 0.10402977558841388.
             46       0.135106       0.104030          00:06
             47       0.134220       0.104590          00:06
Better model found at epoch 48 with valid_loss value: 0.10283426843521015.
             48       0.132884       0.102834          00:06
Better model found at epoch 49 with valid_loss value: 0.10141021864193973.
             49       0.132261       0.101410          00:06
             50       0.131420       0.103289          00:06
             51       0.130531       0.102858          00:06
             52       0.129701       0.101731          00:06
             53       0.129266       0.101854          00:06
Better model found at epoch 54 with valid_loss value: 0.10037516369843981.
             54       0.128099       0.100375          00:06
             55       0.127448       0.102902          00:06
             56       0.127391       0.100648          00:06
             57       0.126479       0.100581          00:06
Better model found at epoch 58 with valid_loss value: 0.09950115392927712.
             58       0.126416       0.099501          00:06
Better model found at epoch 59 with valid_loss value: 0.09875453105381916.
             59       0.125470       0.098755          00:05
             60       0.125029       0.099496          00:06
             61       0.124975       0.100856          00:06
             62       0.124493       0.100775          00:06
             63       0.123762       0.101330          00:06
             64       0.123577       0.101284          00:06
No improvement since epoch 59: early stopping
pretraining completed
Model saved in: saved_models/ES/masked_patchtst/based_model/patchtst_pretrained_cw336_patch12_stride12_epochs-pretrain100_mask0.4_model1
Metrics saved in: saved_models/ES/masked_patchtst/based_model/patchtst_pretrained_cw336_patch12_stride12_epochs-pretrain100_mask0.4_model1_losses.csv
==========Running command for FR, pred_len 24:==========
args: Namespace(dset_pretrain='FR', context_points=168, target_points=24, batch_size=128, num_workers=0, features='M', patch_len=12, stride=12, revin=1, overlapping_windows=True, scaler_type='minmax', if_relu=False, n_layers=3, n_heads=16, d_model=128, d_ff=512, dropout=0.2, head_dropout=0.2, mask_ratio=0.4, n_epochs_pretrain=100, lr=0.0001, pretrained_model_id=1, model_type='based_model')
scaler_type: minmax overlapping_windows: True
number of patches: 14
number of model params 599820
suggested_lr 0.00014174741629268049
scaler_type: minmax overlapping_windows: True
number of patches: 14
number of model params 599820
          epoch     train_loss     valid_loss           time
Better model found at epoch 0 with valid_loss value: 0.8978901569034502.
              0       0.997670       0.897890          00:07
Better model found at epoch 1 with valid_loss value: 0.8540251119661815.
              1       0.909446       0.854025          00:06
Better model found at epoch 2 with valid_loss value: 0.8313600498130127.
              2       0.872087       0.831360          00:07
Better model found at epoch 3 with valid_loss value: 0.8267095577147338.
              3       0.851402       0.826710          00:07
Better model found at epoch 4 with valid_loss value: 0.820903982402083.
              4       0.839625       0.820904          00:06
Better model found at epoch 5 with valid_loss value: 0.8161225646413061.
              5       0.830033       0.816123          00:07
Better model found at epoch 6 with valid_loss value: 0.810348169585411.
              6       0.822083       0.810348          00:07
Better model found at epoch 7 with valid_loss value: 0.8096280391718272.
              7       0.815780       0.809628          00:07
Better model found at epoch 8 with valid_loss value: 0.8060869201885957.
              8       0.810364       0.806087          00:07
Better model found at epoch 9 with valid_loss value: 0.7992838908185218.
              9       0.808305       0.799284          00:07
Better model found at epoch 10 with valid_loss value: 0.7980251352139296.
             10       0.804419       0.798025          00:06
             11       0.803393       0.803924          00:06
             12       0.800367       0.803324          00:06
             13       0.796468       0.800427          00:06
Better model found at epoch 14 with valid_loss value: 0.7966122847384188.
             14       0.797663       0.796612          00:06
             15       0.795372       0.799528          00:07
             16       0.793198       0.798303          00:06
             17       0.793713       0.798036          00:06
             18       0.794204       0.797837          00:07
Better model found at epoch 19 with valid_loss value: 0.46625530457063297.
             19       0.704578       0.466255          00:06
Better model found at epoch 20 with valid_loss value: 0.42889919713587743.
             20       0.493953       0.428899          00:06
Better model found at epoch 21 with valid_loss value: 0.4205358197532974.
             21       0.475683       0.420536          00:06
Better model found at epoch 22 with valid_loss value: 0.4165408591739384.
             22       0.464794       0.416541          00:06
Better model found at epoch 23 with valid_loss value: 0.41381725981934614.
             23       0.458710       0.413817          00:06
Better model found at epoch 24 with valid_loss value: 0.40472358113338425.
             24       0.451497       0.404724          00:06
Better model found at epoch 25 with valid_loss value: 0.3525965142829138.
             25       0.413162       0.352597          00:07
Better model found at epoch 26 with valid_loss value: 0.2886779893148323.
             26       0.369487       0.288678          00:06
Better model found at epoch 27 with valid_loss value: 0.24703644225887686.
             27       0.308948       0.247036          00:07
Better model found at epoch 28 with valid_loss value: 0.21815378558162096.
             28       0.280643       0.218154          00:06
Better model found at epoch 29 with valid_loss value: 0.1919302471738278.
             29       0.258657       0.191930          00:06
Better model found at epoch 30 with valid_loss value: 0.17847325676446638.
             30       0.239676       0.178473          00:06
Better model found at epoch 31 with valid_loss value: 0.17024245437786512.
             31       0.227876       0.170242          00:07
Better model found at epoch 32 with valid_loss value: 0.16629526556468152.
             32       0.219540       0.166295          00:06
Better model found at epoch 33 with valid_loss value: 0.16459002164239686.
             33       0.211866       0.164590          00:06
Better model found at epoch 34 with valid_loss value: 0.16095706030968512.
             34       0.207610       0.160957          00:07
Better model found at epoch 35 with valid_loss value: 0.15751379196218535.
             35       0.203862       0.157514          00:06
Better model found at epoch 36 with valid_loss value: 0.15586808112458783.
             36       0.200475       0.155868          00:06
Better model found at epoch 37 with valid_loss value: 0.1537399402438626.
             37       0.197027       0.153740          00:07
Better model found at epoch 38 with valid_loss value: 0.15248816485418007.
             38       0.193786       0.152488          00:06
Better model found at epoch 39 with valid_loss value: 0.1492385950160598.
             39       0.191976       0.149239          00:06
             40       0.189938       0.149418          00:06
Better model found at epoch 41 with valid_loss value: 0.14570034273149732.
             41       0.187496       0.145700          00:04
Better model found at epoch 42 with valid_loss value: 0.1449861813343202.
             42       0.185093       0.144986          00:05
Better model found at epoch 43 with valid_loss value: 0.143747453350566.
             43       0.182669       0.143747          00:06
Better model found at epoch 44 with valid_loss value: 0.14225140970888792.
             44       0.181380       0.142251          00:05
Better model found at epoch 45 with valid_loss value: 0.1403756561205666.
             45       0.179767       0.140376          00:06
             46       0.178533       0.141420          00:06
Better model found at epoch 47 with valid_loss value: 0.13918735061751045.
             47       0.177077       0.139187          00:06
Better model found at epoch 48 with valid_loss value: 0.13871917552803803.
             48       0.175350       0.138719          00:07
Better model found at epoch 49 with valid_loss value: 0.13699547477870658.
             49       0.175273       0.136995          00:06
Better model found at epoch 50 with valid_loss value: 0.1353408693212663.
             50       0.173222       0.135341          00:04
Better model found at epoch 51 with valid_loss value: 0.13475308810205383.
             51       0.172430       0.134753          00:04
Better model found at epoch 52 with valid_loss value: 0.13441354138915976.
             52       0.170619       0.134414          00:07
Better model found at epoch 53 with valid_loss value: 0.13416782997036855.
             53       0.169477       0.134168          00:06
             54       0.168820       0.135451          00:06
             55       0.167854       0.135073          00:06
Better model found at epoch 56 with valid_loss value: 0.1322204089153229.
             56       0.166586       0.132220          00:06
Better model found at epoch 57 with valid_loss value: 0.13113777856457093.
             57       0.165864       0.131138          00:06
Better model found at epoch 58 with valid_loss value: 0.13077849875467468.
             58       0.164308       0.130778          00:07
             59       0.164606       0.131930          00:06
             60       0.163437       0.131766          00:07
Better model found at epoch 61 with valid_loss value: 0.1297818104592247.
             61       0.162081       0.129782          00:05
             62       0.163668       0.130956          00:06
Better model found at epoch 63 with valid_loss value: 0.12690043468576584.
             63       0.162615       0.126900          00:06
             64       0.161725       0.131736          00:07
             65       0.162337       0.129551          00:06
             66       0.160963       0.127212          00:06
             67       0.160190       0.129260          00:06
             68       0.160412       0.129427          00:06
No improvement since epoch 63: early stopping
pretraining completed
Model saved in: saved_models/FR/masked_patchtst/based_model/patchtst_pretrained_cw168_patch12_stride12_epochs-pretrain100_mask0.4_model1
Metrics saved in: saved_models/FR/masked_patchtst/based_model/patchtst_pretrained_cw168_patch12_stride12_epochs-pretrain100_mask0.4_model1_losses.csv
==========Running command for FR, pred_len 96:==========
args: Namespace(dset_pretrain='FR', context_points=168, target_points=96, batch_size=128, num_workers=0, features='M', patch_len=12, stride=12, revin=1, overlapping_windows=True, scaler_type='minmax', if_relu=False, n_layers=3, n_heads=16, d_model=128, d_ff=512, dropout=0.2, head_dropout=0.2, mask_ratio=0.4, n_epochs_pretrain=100, lr=0.0001, pretrained_model_id=1, model_type='based_model')
scaler_type: minmax overlapping_windows: True
number of patches: 14
number of model params 599820
suggested_lr 0.00043287612810830566
scaler_type: minmax overlapping_windows: True
number of patches: 14
number of model params 599820
          epoch     train_loss     valid_loss           time
Better model found at epoch 0 with valid_loss value: 0.8420660852318959.
              0       0.928776       0.842066          00:06
Better model found at epoch 1 with valid_loss value: 0.8254439426108625.
              1       0.850941       0.825444          00:06
Better model found at epoch 2 with valid_loss value: 0.8174589351098454.
              2       0.831097       0.817459          00:06
Better model found at epoch 3 with valid_loss value: 0.8066917177329129.
              3       0.819094       0.806692          00:07
Better model found at epoch 4 with valid_loss value: 0.8058304515866558.
              4       0.811428       0.805830          00:05
Better model found at epoch 5 with valid_loss value: 0.8054827349471114.
              5       0.806084       0.805483          00:06
Better model found at epoch 6 with valid_loss value: 0.799894079917616.
              6       0.802718       0.799894          00:07
              7       0.800932       0.802551          00:06
Better model found at epoch 8 with valid_loss value: 0.7984111987642393.
              8       0.797234       0.798411          00:06
              9       0.796807       0.798673          00:06
             10       0.796666       0.799314          00:06
Better model found at epoch 11 with valid_loss value: 0.7972223193399105.
             11       0.793810       0.797222          00:06
Better model found at epoch 12 with valid_loss value: 0.442472522757323.
             12       0.656981       0.442473          00:07
Better model found at epoch 13 with valid_loss value: 0.4209363001551058.
             13       0.478762       0.420936          00:07
Better model found at epoch 14 with valid_loss value: 0.4149156215037632.
             14       0.462864       0.414916          00:06
Better model found at epoch 15 with valid_loss value: 0.41085915251220506.
             15       0.453497       0.410859          00:06
Better model found at epoch 16 with valid_loss value: 0.28591302634255494.
             16       0.396355       0.285913          00:06
Better model found at epoch 17 with valid_loss value: 0.24091576373703213.
             17       0.311226       0.240916          00:06
Better model found at epoch 18 with valid_loss value: 0.20766224127847843.
             18       0.271705       0.207662          00:06
Better model found at epoch 19 with valid_loss value: 0.1789676923883747.
             19       0.239350       0.178968          00:07
Better model found at epoch 20 with valid_loss value: 0.16912115731794142.
             20       0.218632       0.169121          00:06
Better model found at epoch 21 with valid_loss value: 0.1567725384109286.
             21       0.205475       0.156773          00:06
Better model found at epoch 22 with valid_loss value: 0.15150267660763325.
             22       0.195372       0.151503          00:06
Better model found at epoch 23 with valid_loss value: 0.14711709453188568.
             23       0.188291       0.147117          00:07
Better model found at epoch 24 with valid_loss value: 0.14283972694390765.
             24       0.181398       0.142840          00:06
Better model found at epoch 25 with valid_loss value: 0.1396396671105828.
             25       0.177943       0.139640          00:06
Better model found at epoch 26 with valid_loss value: 0.13557295772096217.
             26       0.174193       0.135573          00:06
Better model found at epoch 27 with valid_loss value: 0.134176846807618.
             27       0.169926       0.134177          00:06
Better model found at epoch 28 with valid_loss value: 0.13014869534746237.
             28       0.167022       0.130149          00:06
Better model found at epoch 29 with valid_loss value: 0.12868272922599674.
             29       0.164717       0.128683          00:07
Better model found at epoch 30 with valid_loss value: 0.12790044624694874.
             30       0.160861       0.127900          00:06
             31       0.158930       0.128896          00:06
Better model found at epoch 32 with valid_loss value: 0.12773807981908564.
             32       0.158453       0.127738          00:06
Better model found at epoch 33 with valid_loss value: 0.12624392528859846.
             33       0.155347       0.126244          00:07
Better model found at epoch 34 with valid_loss value: 0.12356242093737287.
             34       0.153205       0.123562          00:05
             35       0.152975       0.124479          00:06
Better model found at epoch 36 with valid_loss value: 0.12310866502555431.
             36       0.151687       0.123109          00:06
Better model found at epoch 37 with valid_loss value: 0.1220859561730828.
             37       0.149513       0.122086          00:06
             38       0.148102       0.124949          00:06
Better model found at epoch 39 with valid_loss value: 0.11939033775236473.
             39       0.146468       0.119390          00:07
             40       0.146500       0.122708          00:06
             41       0.146216       0.119592          00:06
Better model found at epoch 42 with valid_loss value: 0.11823215965724165.
             42       0.143714       0.118232          00:06
             43       0.143501       0.121273          00:07
Better model found at epoch 44 with valid_loss value: 0.11763824636709215.
             44       0.142292       0.117638          00:06
             45       0.142009       0.121161          00:06
             46       0.141236       0.121497          00:07
             47       0.141350       0.120382          00:06
             48       0.139992       0.122205          00:06
             49       0.139556       0.121175          00:06
No improvement since epoch 44: early stopping
pretraining completed
Model saved in: saved_models/FR/masked_patchtst/based_model/patchtst_pretrained_cw168_patch12_stride12_epochs-pretrain100_mask0.4_model1
Metrics saved in: saved_models/FR/masked_patchtst/based_model/patchtst_pretrained_cw168_patch12_stride12_epochs-pretrain100_mask0.4_model1_losses.csv
==========Running command for FR, pred_len 168:==========
args: Namespace(dset_pretrain='FR', context_points=168, target_points=168, batch_size=128, num_workers=0, features='M', patch_len=12, stride=12, revin=1, overlapping_windows=True, scaler_type='minmax', if_relu=False, n_layers=3, n_heads=16, d_model=128, d_ff=512, dropout=0.2, head_dropout=0.2, mask_ratio=0.4, n_epochs_pretrain=100, lr=0.0001, pretrained_model_id=1, model_type='based_model')
scaler_type: minmax overlapping_windows: True
number of patches: 14
number of model params 599820
suggested_lr 0.0002477076355991711
scaler_type: minmax overlapping_windows: True
number of patches: 14
number of model params 599820
          epoch     train_loss     valid_loss           time
Better model found at epoch 0 with valid_loss value: 0.8638549181572123.
              0       0.967021       0.863855          00:06
Better model found at epoch 1 with valid_loss value: 0.8349444550932406.
              1       0.875508       0.834944          00:06
Better model found at epoch 2 with valid_loss value: 0.8258475333957681.
              2       0.850839       0.825848          00:06
Better model found at epoch 3 with valid_loss value: 0.8153937478130661.
              3       0.835060       0.815394          00:06
Better model found at epoch 4 with valid_loss value: 0.8136029544191503.
              4       0.826119       0.813603          00:06
Better model found at epoch 5 with valid_loss value: 0.8115327641301663.
              5       0.818174       0.811533          00:06
              6       0.812721       0.811591          00:06
Better model found at epoch 7 with valid_loss value: 0.8040549775903589.
              7       0.807732       0.804055          00:06
              8       0.805134       0.804574          00:05
Better model found at epoch 9 with valid_loss value: 0.803088867348304.
              9       0.802614       0.803089          00:06
Better model found at epoch 10 with valid_loss value: 0.8029998623518031.
             10       0.799513       0.803000          00:06
Better model found at epoch 11 with valid_loss value: 0.7986238235581673.
             11       0.799269       0.798624          00:06
             12       0.797721       0.801417          00:06
             13       0.796596       0.802583          00:06
             14       0.794398       0.799735          00:06
             15       0.794607       0.803830          00:06
Better model found at epoch 16 with valid_loss value: 0.5058332041541453.
             16       0.760803       0.505833          00:06
Better model found at epoch 17 with valid_loss value: 0.43528765900296396.
             17       0.500298       0.435288          00:06
Better model found at epoch 18 with valid_loss value: 0.4264445261685946.
             18       0.471702       0.426445          00:06
Better model found at epoch 19 with valid_loss value: 0.41714965478604066.
             19       0.461441       0.417150          00:06
Better model found at epoch 20 with valid_loss value: 0.414161153234604.
             20       0.456849       0.414161          00:06
Better model found at epoch 21 with valid_loss value: 0.41092055126173227.
             21       0.444955       0.410921          00:06
Better model found at epoch 22 with valid_loss value: 0.336743931901449.
             22       0.391199       0.336744          00:06
Better model found at epoch 23 with valid_loss value: 0.24365200204156717.
             23       0.324345       0.243652          00:06
Better model found at epoch 24 with valid_loss value: 0.20820779233518236.
             24       0.273180       0.208208          00:07
Better model found at epoch 25 with valid_loss value: 0.19144904395608636.
             25       0.243475       0.191449          00:06
Better model found at epoch 26 with valid_loss value: 0.18097761013785402.
             26       0.228754       0.180978          00:06
Better model found at epoch 27 with valid_loss value: 0.17338424574577022.
             27       0.219027       0.173384          00:06
Better model found at epoch 28 with valid_loss value: 0.16707832817581406.
             28       0.210148       0.167078          00:06
Better model found at epoch 29 with valid_loss value: 0.16328896256033365.
             29       0.203780       0.163289          00:06
Better model found at epoch 30 with valid_loss value: 0.15950244116504406.
             30       0.203509       0.159502          00:06
Better model found at epoch 31 with valid_loss value: 0.1565036280591347.
             31       0.195104       0.156504          00:06
Better model found at epoch 32 with valid_loss value: 0.14989073571353223.
             32       0.191821       0.149891          00:06
Better model found at epoch 33 with valid_loss value: 0.14949644438305307.
             33       0.188840       0.149496          00:06
Better model found at epoch 34 with valid_loss value: 0.14773440474873414.
             34       0.186111       0.147734          00:06
Better model found at epoch 35 with valid_loss value: 0.14195892921923883.
             35       0.182733       0.141959          00:06
             36       0.180335       0.144768          00:06
Better model found at epoch 37 with valid_loss value: 0.14147044696427835.
             37       0.177639       0.141470          00:06
Better model found at epoch 38 with valid_loss value: 0.13943391495592686.
             38       0.175766       0.139434          00:06
             39       0.173763       0.142147          00:06
             40       0.171822       0.142065          00:05
Better model found at epoch 41 with valid_loss value: 0.1368024484655442.
             41       0.171173       0.136802          00:05
Better model found at epoch 42 with valid_loss value: 0.1343208311732.
             42       0.169100       0.134321          00:06
Better model found at epoch 43 with valid_loss value: 0.13203048015100136.
             43       0.168610       0.132030          00:06
             44       0.166084       0.136644          00:05
             45       0.164497       0.133120          00:06
             46       0.163949       0.134171          00:05
Better model found at epoch 47 with valid_loss value: 0.1319405806824263.
             47       0.161749       0.131941          00:05
             48       0.164156       0.135474          00:06
             49       0.161470       0.131999          00:06
Better model found at epoch 50 with valid_loss value: 0.13033917416227564.
             50       0.161106       0.130339          00:06
Better model found at epoch 51 with valid_loss value: 0.12954468195547916.
             51       0.158587       0.129545          00:05
Better model found at epoch 52 with valid_loss value: 0.12766229060107237.
             52       0.161616       0.127662          00:06
             53       0.157708       0.128071          00:06
             54       0.156773       0.132119          00:06
Better model found at epoch 55 with valid_loss value: 0.12615275339810947.
             55       0.155541       0.126153          00:06
             56       0.155286       0.127484          00:06
             57       0.154722       0.126355          00:06
             58       0.153322       0.128464          00:06
Better model found at epoch 59 with valid_loss value: 0.12449673383019616.
             59       0.153042       0.124497          00:06
             60       0.152190       0.125358          00:06
             61       0.152303       0.128157          00:06
             62       0.150690       0.127417          00:06
             63       0.150546       0.126029          00:05
Better model found at epoch 64 with valid_loss value: 0.12378641245060103.
             64       0.150754       0.123786          00:05
             65       0.149388       0.127968          00:07
             66       0.148747       0.127534          00:07
             67       0.148349       0.125273          00:06
             68       0.149271       0.126246          00:05
             69       0.148833       0.125960          00:06
No improvement since epoch 64: early stopping
pretraining completed
Model saved in: saved_models/FR/masked_patchtst/based_model/patchtst_pretrained_cw168_patch12_stride12_epochs-pretrain100_mask0.4_model1
Metrics saved in: saved_models/FR/masked_patchtst/based_model/patchtst_pretrained_cw168_patch12_stride12_epochs-pretrain100_mask0.4_model1_losses.csv
==========Running command for IT, pred_len 24:==========
args: Namespace(dset_pretrain='IT', context_points=168, target_points=24, batch_size=128, num_workers=0, features='M', patch_len=12, stride=12, revin=1, overlapping_windows=True, scaler_type='minmax', if_relu=False, n_layers=3, n_heads=16, d_model=128, d_ff=512, dropout=0.2, head_dropout=0.2, mask_ratio=0.4, n_epochs_pretrain=100, lr=0.0001, pretrained_model_id=1, model_type='based_model')
scaler_type: minmax overlapping_windows: True
number of patches: 14
number of model params 599820
suggested_lr 0.0002477076355991711
scaler_type: minmax overlapping_windows: True
number of patches: 14
number of model params 599820
          epoch     train_loss     valid_loss           time
Better model found at epoch 0 with valid_loss value: 0.8745827971690526.
              0       0.972396       0.874583          00:07
Better model found at epoch 1 with valid_loss value: 0.8427037727953595.
              1       0.882842       0.842704          00:07
Better model found at epoch 2 with valid_loss value: 0.8355703269513028.
              2       0.856518       0.835570          00:07
Better model found at epoch 3 with valid_loss value: 0.8303570194376307.
              3       0.844422       0.830357          00:07
Better model found at epoch 4 with valid_loss value: 0.8277831952710311.
              4       0.835501       0.827783          00:07
Better model found at epoch 5 with valid_loss value: 0.8245751631112272.
              5       0.830474       0.824575          00:06
Better model found at epoch 6 with valid_loss value: 0.8245588268557986.
              6       0.824034       0.824559          00:06
Better model found at epoch 7 with valid_loss value: 0.8170245929759128.
              7       0.822022       0.817025          00:06
              8       0.818166       0.818914          00:06
Better model found at epoch 9 with valid_loss value: 0.8159305351003298.
              9       0.817046       0.815931          00:07
             10       0.814506       0.816078          00:06
Better model found at epoch 11 with valid_loss value: 0.81396484375.
             11       0.813453       0.813965          00:07
Better model found at epoch 12 with valid_loss value: 0.8085687743787197.
             12       0.812433       0.808569          00:07
Better model found at epoch 13 with valid_loss value: 0.4416218414478446.
             13       0.611501       0.441622          00:07
Better model found at epoch 14 with valid_loss value: 0.4215628832736851.
             14       0.464557       0.421563          00:06
Better model found at epoch 15 with valid_loss value: 0.41410734616273925.
             15       0.449495       0.414107          00:07
Better model found at epoch 16 with valid_loss value: 0.41202796861177016.
             16       0.440963       0.412028          00:06
Better model found at epoch 17 with valid_loss value: 0.40558017425758003.
             17       0.435213       0.405580          00:05
             18       0.429699       0.406581          00:06
Better model found at epoch 19 with valid_loss value: 0.40201030974796925.
             19       0.425763       0.402010          00:07
Better model found at epoch 20 with valid_loss value: 0.26619260633645647.
             20       0.375679       0.266193          00:06
Better model found at epoch 21 with valid_loss value: 0.22594303783351094.
             21       0.273080       0.225943          00:06
Better model found at epoch 22 with valid_loss value: 0.2124189745292645.
             22       0.251189       0.212419          00:06
Better model found at epoch 23 with valid_loss value: 0.18953892961084526.
             23       0.232484       0.189539          00:06
Better model found at epoch 24 with valid_loss value: 0.16359659274406366.
             24       0.211305       0.163597          00:06
Better model found at epoch 25 with valid_loss value: 0.15769155673204518.
             25       0.196952       0.157692          00:06
Better model found at epoch 26 with valid_loss value: 0.1560439707593594.
             26       0.188536       0.156044          00:06
Better model found at epoch 27 with valid_loss value: 0.1522746743430312.
             27       0.182524       0.152275          00:06
Better model found at epoch 28 with valid_loss value: 0.15219300288334908.
             28       0.178486       0.152193          00:06
Better model found at epoch 29 with valid_loss value: 0.14979175004963707.
             29       0.173118       0.149792          00:07
Better model found at epoch 30 with valid_loss value: 0.14441652314847395.
             30       0.169280       0.144417          00:07
Better model found at epoch 31 with valid_loss value: 0.14323348962207957.
             31       0.166949       0.143233          00:06
Better model found at epoch 32 with valid_loss value: 0.1376714069819899.
             32       0.163336       0.137671          00:06
             33       0.160515       0.138177          00:06
Better model found at epoch 34 with valid_loss value: 0.13556546338102682.
             34       0.158027       0.135565          00:06
Better model found at epoch 35 with valid_loss value: 0.13299293511930493.
             35       0.155364       0.132993          00:07
Better model found at epoch 36 with valid_loss value: 0.1313731718316461.
             36       0.153401       0.131373          00:06
             37       0.151130       0.132016          00:07
Better model found at epoch 38 with valid_loss value: 0.1294212543793731.
             38       0.149527       0.129421          00:06
Better model found at epoch 39 with valid_loss value: 0.12849860937625662.
             39       0.147363       0.128499          00:06
Better model found at epoch 40 with valid_loss value: 0.12659041889614667.
             40       0.146502       0.126590          00:04
Better model found at epoch 41 with valid_loss value: 0.12600213698641327.
             41       0.144084       0.126002          00:06
Better model found at epoch 42 with valid_loss value: 0.12538885982047712.
             42       0.142945       0.125389          00:06
             43       0.142320       0.128509          00:07
Better model found at epoch 44 with valid_loss value: 0.12418543542718051.
             44       0.141205       0.124185          00:06
Better model found at epoch 45 with valid_loss value: 0.12210563572538001.
             45       0.139960       0.122106          00:07
             46       0.138972       0.122852          00:06
             47       0.138078       0.124289          00:07
             48       0.136965       0.123080          00:07
             49       0.136299       0.122666          00:06
             50       0.134906       0.122598          00:06
No improvement since epoch 45: early stopping
pretraining completed
Model saved in: saved_models/IT/masked_patchtst/based_model/patchtst_pretrained_cw168_patch12_stride12_epochs-pretrain100_mask0.4_model1
Metrics saved in: saved_models/IT/masked_patchtst/based_model/patchtst_pretrained_cw168_patch12_stride12_epochs-pretrain100_mask0.4_model1_losses.csv
==========Running command for IT, pred_len 96:==========
args: Namespace(dset_pretrain='IT', context_points=168, target_points=96, batch_size=128, num_workers=0, features='M', patch_len=12, stride=12, revin=1, overlapping_windows=True, scaler_type='minmax', if_relu=False, n_layers=3, n_heads=16, d_model=128, d_ff=512, dropout=0.2, head_dropout=0.2, mask_ratio=0.4, n_epochs_pretrain=100, lr=0.0001, pretrained_model_id=1, model_type='based_model')
scaler_type: minmax overlapping_windows: True
number of patches: 14
number of model params 599820
suggested_lr 0.000298364724028334
scaler_type: minmax overlapping_windows: True
number of patches: 14
number of model params 599820
          epoch     train_loss     valid_loss           time
Better model found at epoch 0 with valid_loss value: 0.8647887637306754.
              0       0.960356       0.864789          00:06
Better model found at epoch 1 with valid_loss value: 0.8395143886035394.
              1       0.873368       0.839514          00:07
Better model found at epoch 2 with valid_loss value: 0.8297927844029699.
              2       0.852136       0.829793          00:06
              3       0.840049       0.830188          00:06
Better model found at epoch 4 with valid_loss value: 0.8226923248067535.
              4       0.833057       0.822692          00:06
Better model found at epoch 5 with valid_loss value: 0.8214084907699349.
              5       0.827598       0.821408          00:06
Better model found at epoch 6 with valid_loss value: 0.8170419294141579.
              6       0.820683       0.817042          00:06
              7       0.817675       0.817727          00:06
              8       0.818387       0.818745          00:06
Better model found at epoch 9 with valid_loss value: 0.816734419497559.
              9       0.815302       0.816734          00:07
Better model found at epoch 10 with valid_loss value: 0.815260596775834.
             10       0.811038       0.815261          00:06
Better model found at epoch 11 with valid_loss value: 0.8141890796633442.
             11       0.811373       0.814189          00:06
Better model found at epoch 12 with valid_loss value: 0.43928959647070787.
             12       0.600259       0.439290          00:06
Better model found at epoch 13 with valid_loss value: 0.41921166217453215.
             13       0.461181       0.419212          00:05
Better model found at epoch 14 with valid_loss value: 0.4139521698916802.
             14       0.446531       0.413952          00:06
Better model found at epoch 15 with valid_loss value: 0.4082382860175956.
             15       0.438403       0.408238          00:07
             16       0.432622       0.409369          00:06
Better model found at epoch 17 with valid_loss value: 0.4044677535725183.
             17       0.428169       0.404468          00:06
Better model found at epoch 18 with valid_loss value: 0.36433119374237183.
             18       0.417442       0.364331          00:06
Better model found at epoch 19 with valid_loss value: 0.24639915422853947.
             19       0.327425       0.246399          00:06
Better model found at epoch 20 with valid_loss value: 0.1895507613850183.
             20       0.254838       0.189551          00:06
Better model found at epoch 21 with valid_loss value: 0.16608761569365338.
             21       0.215981       0.166088          00:06
Better model found at epoch 22 with valid_loss value: 0.1600031009236422.
             22       0.199210       0.160003          00:06
Better model found at epoch 23 with valid_loss value: 0.15563454313720504.
             23       0.188787       0.155635          00:07
Better model found at epoch 24 with valid_loss value: 0.15134422358116353.
             24       0.180274       0.151344          00:07
Better model found at epoch 25 with valid_loss value: 0.14884800984667412.
             25       0.175372       0.148848          00:06
Better model found at epoch 26 with valid_loss value: 0.14462834009802178.
             26       0.171017       0.144628          00:06
Better model found at epoch 27 with valid_loss value: 0.13942835336782955.
             27       0.166149       0.139428          00:06
             28       0.162605       0.140557          00:06
Better model found at epoch 29 with valid_loss value: 0.13756359773888832.
             29       0.159621       0.137564          00:07
Better model found at epoch 30 with valid_loss value: 0.13343460169917107.
             30       0.156945       0.133435          00:06
Better model found at epoch 31 with valid_loss value: 0.13176229801286615.
             31       0.153093       0.131762          00:06
Better model found at epoch 32 with valid_loss value: 0.12917260960702298.
             32       0.151299       0.129173          00:06
Better model found at epoch 33 with valid_loss value: 0.12818953139302786.
             33       0.148424       0.128190          00:07
Better model found at epoch 34 with valid_loss value: 0.12590532667565094.
             34       0.147032       0.125905          00:06
Better model found at epoch 35 with valid_loss value: 0.12292455637522884.
             35       0.145167       0.122925          00:07
             36       0.143420       0.128264          00:07
Better model found at epoch 37 with valid_loss value: 0.12222559706188975.
             37       0.142355       0.122226          00:06
             38       0.140266       0.125835          00:06
             39       0.139772       0.124671          00:06
Better model found at epoch 40 with valid_loss value: 0.12192051067305737.
             40       0.138927       0.121921          00:05
Better model found at epoch 41 with valid_loss value: 0.12188821021282546.
             41       0.137656       0.121888          00:07
Better model found at epoch 42 with valid_loss value: 0.12061637462494915.
             42       0.137014       0.120616          00:06
Better model found at epoch 43 with valid_loss value: 0.11889640491507324.
             43       0.136081       0.118896          00:06
Better model found at epoch 44 with valid_loss value: 0.118225872390536.
             44       0.134191       0.118226          00:07
             45       0.134166       0.122699          00:07
             46       0.133264       0.120428          00:06
             47       0.132532       0.122116          00:06
             48       0.131173       0.122069          00:06
             49       0.131421       0.118696          00:06
No improvement since epoch 44: early stopping
pretraining completed
Model saved in: saved_models/IT/masked_patchtst/based_model/patchtst_pretrained_cw168_patch12_stride12_epochs-pretrain100_mask0.4_model1
Metrics saved in: saved_models/IT/masked_patchtst/based_model/patchtst_pretrained_cw168_patch12_stride12_epochs-pretrain100_mask0.4_model1_losses.csv
==========Running command for IT, pred_len 168:==========
args: Namespace(dset_pretrain='IT', context_points=168, target_points=168, batch_size=128, num_workers=0, features='M', patch_len=12, stride=12, revin=1, overlapping_windows=True, scaler_type='minmax', if_relu=False, n_layers=3, n_heads=16, d_model=128, d_ff=512, dropout=0.2, head_dropout=0.2, mask_ratio=0.4, n_epochs_pretrain=100, lr=0.0001, pretrained_model_id=1, model_type='based_model')
scaler_type: minmax overlapping_windows: True
number of patches: 14
number of model params 599820
suggested_lr 0.0002477076355991711
scaler_type: minmax overlapping_windows: True
number of patches: 14
number of model params 599820
          epoch     train_loss     valid_loss           time
Better model found at epoch 0 with valid_loss value: 0.8747608040970278.
              0       0.972244       0.874761          00:06
Better model found at epoch 1 with valid_loss value: 0.8420144427692244.
              1       0.884144       0.842014          00:04
Better model found at epoch 2 with valid_loss value: 0.8365881128560843.
              2       0.858477       0.836588          00:06
Better model found at epoch 3 with valid_loss value: 0.8325608578698749.
              3       0.845650       0.832561          00:06
Better model found at epoch 4 with valid_loss value: 0.8291896026726906.
              4       0.837978       0.829190          00:05
Better model found at epoch 5 with valid_loss value: 0.8268291612207723.
              5       0.832017       0.826829          00:05
Better model found at epoch 6 with valid_loss value: 0.8226642580376256.
              6       0.825856       0.822664          00:05
Better model found at epoch 7 with valid_loss value: 0.8188431537388853.
              7       0.821406       0.818843          00:05
              8       0.819610       0.821039          00:06
Better model found at epoch 9 with valid_loss value: 0.817663335022847.
              9       0.817190       0.817663          00:06
             10       0.814317       0.821204          00:06
             11       0.814791       0.819042          00:06
Better model found at epoch 12 with valid_loss value: 0.8166937674954717.
             12       0.814753       0.816694          00:06
Better model found at epoch 13 with valid_loss value: 0.8149680193067677.
             13       0.810652       0.814968          00:07
Better model found at epoch 14 with valid_loss value: 0.46403434322513587.
             14       0.710888       0.464034          00:06
Better model found at epoch 15 with valid_loss value: 0.4287432590976453.
             15       0.473380       0.428743          00:06
Better model found at epoch 16 with valid_loss value: 0.42366973309114114.
             16       0.452864       0.423670          00:06
Better model found at epoch 17 with valid_loss value: 0.4123360281934382.
             17       0.443426       0.412336          00:06
Better model found at epoch 18 with valid_loss value: 0.4109359482417051.
             18       0.436911       0.410936          00:06
             19       0.431854       0.415140          00:04
             20       0.430845       0.412627          00:05
Better model found at epoch 21 with valid_loss value: 0.40830226064650915.
             21       0.425466       0.408302          00:06
Better model found at epoch 22 with valid_loss value: 0.31263873362372385.
             22       0.384663       0.312639          00:06
Better model found at epoch 23 with valid_loss value: 0.23050945350449736.
             23       0.279100       0.230509          00:06
Better model found at epoch 24 with valid_loss value: 0.22085974806520664.
             24       0.250491       0.220860          00:05
Better model found at epoch 25 with valid_loss value: 0.19271443048380124.
             25       0.236142       0.192714          00:05
Better model found at epoch 26 with valid_loss value: 0.1925418878257245.
             26       0.222851       0.192542          00:06
Better model found at epoch 27 with valid_loss value: 0.18137212257378973.
             27       0.214187       0.181372          00:06
Better model found at epoch 28 with valid_loss value: 0.17226802499922814.
             28       0.202570       0.172268          00:06
Better model found at epoch 29 with valid_loss value: 0.16751024763489522.
             29       0.194541       0.167510          00:06
Better model found at epoch 30 with valid_loss value: 0.15757017042969393.
             30       0.189967       0.157570          00:05
             31       0.184748       0.162610          00:05
Better model found at epoch 32 with valid_loss value: 0.150075831131391.
             32       0.180709       0.150076          00:06
             33       0.176341       0.151010          00:06
             34       0.174112       0.153001          00:05
             35       0.172741       0.150797          00:06
Better model found at epoch 36 with valid_loss value: 0.14484910919425634.
             36       0.169017       0.144849          00:06
Better model found at epoch 37 with valid_loss value: 0.14145763289804772.
             37       0.165442       0.141458          00:05
             38       0.164207       0.147645          00:06
Better model found at epoch 39 with valid_loss value: 0.14034677898395048.
             39       0.164865       0.140347          00:06
Better model found at epoch 40 with valid_loss value: 0.13789263906970403.
             40       0.160715       0.137893          00:06
             41       0.157406       0.139420          00:07
Better model found at epoch 42 with valid_loss value: 0.13739421711944777.
             42       0.157774       0.137394          00:06
Better model found at epoch 43 with valid_loss value: 0.1359174839260353.
             43       0.156202       0.135917          00:06
Better model found at epoch 44 with valid_loss value: 0.12874224000249568.
             44       0.155055       0.128742          00:06
             45       0.152652       0.130165          00:06
             46       0.150282       0.130689          00:07
             47       0.148739       0.130640          00:06
             48       0.148687       0.131231          00:06
Better model found at epoch 49 with valid_loss value: 0.12865255158912914.
             49       0.148871       0.128653          00:06
             50       0.146294       0.129603          00:05
             51       0.145428       0.130241          00:06
Better model found at epoch 52 with valid_loss value: 0.12636044177352626.
             52       0.144874       0.126360          00:06
             53       0.143024       0.127007          00:06
             54       0.142100       0.127423          00:06
Better model found at epoch 55 with valid_loss value: 0.12327524678585028.
             55       0.144831       0.123275          00:06
Better model found at epoch 56 with valid_loss value: 0.12307303579560658.
             56       0.140576       0.123073          00:06
             57       0.139583       0.124355          00:06
             58       0.139852       0.123322          00:06
             59       0.139265       0.125793          00:06
             60       0.139471       0.123092          00:06
             61       0.137653       0.123303          00:07
Better model found at epoch 62 with valid_loss value: 0.12029514724176169.
             62       0.137140       0.120295          00:06
             63       0.136959       0.123519          00:06
             64       0.135495       0.122569          00:07
Better model found at epoch 65 with valid_loss value: 0.11883065525044254.
             65       0.135244       0.118831          00:07
             66       0.134112       0.119865          00:06
             67       0.134284       0.120290          00:06
             68       0.134068       0.121510          00:06
             69       0.133808       0.119748          00:06
             70       0.133855       0.120308          00:06
Better model found at epoch 71 with valid_loss value: 0.11726311806613288.
             71       0.133015       0.117263          00:06
             72       0.133245       0.119243          00:06
             73       0.131929       0.119092          00:06
             74       0.133436       0.120602          00:06
             75       0.131917       0.120100          00:06
             76       0.132160       0.121577          00:06
No improvement since epoch 71: early stopping
pretraining completed
Model saved in: saved_models/IT/masked_patchtst/based_model/patchtst_pretrained_cw168_patch12_stride12_epochs-pretrain100_mask0.4_model1
Metrics saved in: saved_models/IT/masked_patchtst/based_model/patchtst_pretrained_cw168_patch12_stride12_epochs-pretrain100_mask0.4_model1_losses.csv
Total time: 01h:51m:49.63s
